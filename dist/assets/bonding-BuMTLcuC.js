import"./overlay-menu-BiuOw_Vj.js";import{Pane as pe}from"https://cdn.skypack.dev/tweakpane@4.0.4";window.Pane=pe;gsap.registerPlugin(CustomEase);CustomEase.create("hop","0.9, 0, 0.1, 1");const V=["WeDes tổ chức buổi sharing đầu tiên","Tham quan PTIT","Chị Dung và thằng đệ","Chụp ảnh nhưng quạu","Ngục tù tăm tối","Chị Dung và áo chống nắng cute","Chill hội làng Dương","Ngục tù tăm tối v2","Chúng mình cùng học","Một buổi sinh nhật ý nghĩa","Workshop đầu tiên","Tác phẩm mô di ắc","Đi ăn chè","Tham quan kiến trúc","Sinh nhật nè","Gương thần","WeDes check in triển lãm","Năm mới đầy quà","Quà nè","Giáng sinh nhiều quà"],ge="/",oe=Array.from({length:20},(e,n)=>`${ge}img/team${n+1}.png`),B=document.querySelector(".container"),q=document.getElementById("canvas"),D=document.getElementById("overlay"),ae=document.querySelector(".project-title p"),t={baseWidth:600,smallHeight:400,largeHeight:700,itemGap:65,hoverScale:1.05,expandedScale:.4,dragEase:.04,momentumFactor:200,bufferZone:3,borderRadius:0,vignetteSize:0,vignetteStrength:.7,vignetteSize:200,overlayOpacity:.9,overlayEaseDuration:.8,zoomDuration:.6};let U=[{width:t.baseWidth,height:t.smallHeight},{width:t.baseWidth,height:t.largeHeight}];t.itemGap;let _=4;const he=V.length;let G=t.baseWidth+t.itemGap,X=Math.max(t.smallHeight,t.largeHeight)+t.itemGap,y=!1,M,P,L=0,N=0,S=0,E=0,Y=0,A=0,se=0,R=!1,H=new Set,de=0,le=0,re=0,C=!1,Q=null,T=null,w=!0,h=null,l=null,W=null,$=null,g=null;function ce(){if(!window.Pane){setTimeout(ce,100);return}g=new window.Pane({title:"Gallery Settings",expanded:!1});const e=g.element;e.style.position="fixed",e.style.top="10px",e.style.right="10px",e.style.zIndex="10000";const n=g.addFolder({title:"Item Sizes",expanded:!1});n.addBinding(t,"baseWidth",{min:100,max:600,step:10}).on("change",F),n.addBinding(t,"smallHeight",{min:100,max:400,step:10}).on("change",F),n.addBinding(t,"largeHeight",{min:100,max:600,step:10}).on("change",F);const o=g.addFolder({title:"Layout",expanded:!1});o.addBinding(t,"itemGap",{min:0,max:100,step:5}).on("change",F),o.addBinding(t,"bufferZone",{min:1,max:5,step:.5}).on("change",F),g.addFolder({title:"Style",expanded:!1}).addBinding(t,"borderRadius",{min:0,max:16,step:1}).on("change",J),g.addFolder({title:"Item Vignette",expanded:!1}).addBinding(t,"vignetteSize",{min:0,max:50,step:1}).on("change",K);const i=g.addFolder({title:"Page Vignette",expanded:!1});i.addBinding(t,"vignetteStrength",{min:0,max:1,step:.05}).on("change",Z),i.addBinding(t,"vignetteSize",{min:0,max:500,step:10}).on("change",Z);const p=g.addFolder({title:"Overlay Animation",expanded:!1});p.addBinding(t,"overlayOpacity",{min:0,max:1,step:.05}),p.addBinding(t,"overlayEaseDuration",{min:.2,max:2,step:.1});const u=g.addFolder({title:"Animation",expanded:!1});u.addBinding(t,"hoverScale",{min:1,max:1.5,step:.05}).on("change",ee),u.addBinding(t,"expandedScale",{min:.2,max:.8,step:.05}),u.addBinding(t,"dragEase",{min:.01,max:.2,step:.01}),u.addBinding(t,"momentumFactor",{min:50,max:500,step:10}),u.addBinding(t,"zoomDuration",{min:.2,max:1.5,step:.1}),g.addButton({title:"Reset View"}).on("click",()=>{L=0,N=0}),window.addEventListener("keydown",s=>{(s.key==="h"||s.key==="H")&&ye()})}function ye(){if(!g)return;const e=g.element;e.style.display==="none"?e.style.display="":e.style.display="none"}function J(){document.documentElement.style.setProperty("--border-radius",`${t.borderRadius}px`)}function K(){document.documentElement.style.setProperty("--vignette-size",`${t.vignetteSize}px`)}function Z(){const e=t.vignetteStrength,n=t.vignetteSize,o=e*.7,m=n*1.5;document.documentElement.style.setProperty("--page-vignette-size",`${m}px`),document.documentElement.style.setProperty("--page-vignette-color",`rgba(0,0,0,${o})`);const a=e*.85,i=n*.75;document.documentElement.style.setProperty("--page-vignette-strong-size",`${i}px`),document.documentElement.style.setProperty("--page-vignette-strong-color",`rgba(0,0,0,${a})`);const p=e,u=n*.4;document.documentElement.style.setProperty("--page-vignette-extreme-size",`${u}px`),document.documentElement.style.setProperty("--page-vignette-extreme-color",`rgba(0,0,0,${p})`)}function ee(){document.documentElement.style.setProperty("--hover-scale",t.hoverScale),document.querySelectorAll(".item").forEach(e=>{const n=e.querySelector("img");n&&(n.style.transition="transform 0.3s ease")})}function F(){U=[{width:t.baseWidth,height:t.smallHeight},{width:t.baseWidth,height:t.largeHeight}],t.itemGap,_=4,G=t.baseWidth+t.itemGap,X=Math.max(t.smallHeight,t.largeHeight)+t.itemGap,H.forEach(e=>{const n=document.getElementById(e);n&&n.parentNode===q&&q.removeChild(n)}),H.clear(),j(),J(),K(),ee(),Z()}function we(e){$&&$.revert(),ae.textContent=e,$=new SplitType(ae,{types:"words"}),gsap.set($.words,{y:"100%"})}function fe(){gsap.fromTo($.words,{y:"100%",opacity:0},{y:"0%",opacity:1,duration:1,stagger:.1,ease:"power3.out"})}function xe(){gsap.to($.words,{y:"-100%",opacity:0,duration:1,stagger:.1,ease:"power3.out"})}function ve(){W&&W.kill(),W=gsap.to(D,{opacity:t.overlayOpacity,duration:t.overlayEaseDuration,ease:"power2.inOut",overwrite:!0})}function be(){W&&W.kill(),W=gsap.to(D,{opacity:0,duration:t.overlayEaseDuration,ease:"power2.inOut"})}function Se(e,n){const o=Math.abs((e*_+n)%U.length);return U[o]}function Ee(e,n){return`${e},${n}`}function Ce(e,n){const o=e*G,m=n*X;return{x:o,y:m}}function j(){const e=t.bufferZone,n=window.innerWidth*(1+e),o=window.innerHeight*(1+e),m=Math.floor((-S-n/2)/G),a=Math.ceil((-S+n*1.5)/G),i=Math.floor((-E-o/2)/X),p=Math.ceil((-E+o*1.5)/X),u=new Set;for(let s=i;s<=p;s++)for(let c=m;c<=a;c++){const d=Ee(c,s);if(u.add(d),H.has(d)||T===d&&C)continue;const I=Se(s,c),O=Ce(c,s),r=document.createElement("div");r.className="item",r.id=d,r.style.width=`${I.width}px`,r.style.height=`${I.height}px`,r.style.left=`${O.x}px`,r.style.top=`${O.y}px`,r.dataset.col=c,r.dataset.row=s,r.dataset.width=I.width,r.dataset.height=I.height;const f=Math.abs((s*_+c)%he),x=document.createElement("div");x.className="item-image-container";const v=document.createElement("img");v.src=oe[f%oe.length],v.alt=`Image ${f+1}`,x.appendChild(v),r.appendChild(x);const b=document.createElement("div");b.className="item-caption";const k=document.createElement("div");k.className="item-name",k.textContent=V[f],b.appendChild(k);const z=document.createElement("div");z.className="item-number",z.textContent=`#${(f+1).toString().padStart(5,"0")}`,b.appendChild(z),r.appendChild(b),r.addEventListener("click",ne=>{R||y||Ie(r,f)}),q.appendChild(r),H.add(d)}H.forEach(s=>{if(!u.has(s)||T===s&&C){const c=document.getElementById(s);c&&c.parentNode===q&&q.removeChild(c),H.delete(s)}})}function Ie(e,n){C?l&&te():ze(e,n)}function ze(e,n){C=!0,Q=e,T=e.id,w=!1,B.style.cursor="auto";const o=e.querySelector("img").src,m=n%V.length,a=parseInt(e.dataset.width),i=parseInt(e.dataset.height);we(V[m]);const p=e.querySelector(".item-name"),u=e.querySelector(".item-number"),s=p.textContent,c=u.textContent,d=e.querySelector(".item-caption").cloneNode(!0);d.classList.add("caption-clone");const I=d.querySelector(".item-name"),O=d.querySelector(".item-number"),r=new SplitType(I,{types:"words"}),f=new SplitType(O,{types:"words"}),x=e.querySelector(".item-caption").getBoundingClientRect();d.style.left=`${x.left}px`,d.style.bottom=`${window.innerHeight-x.bottom}px`,d.style.width=`${x.width}px`,d.style.zIndex="10002",document.body.appendChild(d),e.querySelector(".item-caption").style.opacity="0",gsap.to(r.words,{y:"100%",opacity:0,duration:.6,stagger:.03,ease:"power3.in"}),gsap.to(f.words,{y:"100%",opacity:0,duration:.6,stagger:.02,delay:.05,ease:"power3.in",onComplete:()=>{d.parentNode&&document.body.removeChild(d)}});const v=e.getBoundingClientRect();h={id:e.id,rect:v,imgSrc:o,width:a,height:i,nameText:s,numberText:c},D.classList.add("active"),ve(),l=document.createElement("div"),l.className="expanded-item",l.style.width=`${a}px`,l.style.height=`${i}px`,l.style.zIndex="10000",l.style.borderRadius="var(--border-radius, 0px)";const b=document.createElement("img");b.src=o,l.appendChild(b),l.addEventListener("click",te),document.body.appendChild(l),document.querySelectorAll(".item").forEach(ie=>{ie!==Q&&gsap.to(ie,{opacity:0,duration:t.overlayEaseDuration,ease:"power2.inOut"})});const z=window.innerWidth*t.expandedScale,ne=i/a,ue=z*ne;gsap.delayedCall(.5,fe),gsap.fromTo(l,{width:a,height:i,x:v.left+a/2-window.innerWidth/2,y:v.top+i/2-window.innerHeight/2},{width:z,height:ue,x:0,y:0,duration:t.zoomDuration,ease:"hop"})}function te(){if(!l||!h)return;xe(),be(),document.querySelectorAll(".item").forEach(a=>{a.id!==T&&gsap.to(a,{opacity:1,duration:t.overlayEaseDuration,delay:.3,ease:"power2.inOut"})});const e=document.getElementById(T);if(e){const a=e.querySelector(".item-name"),i=e.querySelector(".item-number");a.textContent=h.nameText,i.textContent=h.numberText,e.querySelector(".item-caption").style.opacity="0"}const n=h.rect,o=h.width,m=h.height;gsap.to(l,{width:o,height:m,x:n.left+o/2-window.innerWidth/2,y:n.top+m/2-window.innerHeight/2,duration:t.zoomDuration,ease:"hop",onComplete:()=>{if(e){const a=e.querySelector(".item-caption"),i=document.createElement("div");i.className="caption-clone",i.innerHTML=a.innerHTML;const p=a.getBoundingClientRect();i.style.position="fixed",i.style.left=`${p.left}px`,i.style.bottom=`${window.innerHeight-p.bottom}px`,i.style.width=`${p.width}px`,i.style.padding="10px",i.style.zIndex="10002",document.body.appendChild(i);const u=i.querySelector(".item-name"),s=i.querySelector(".item-number");u.style.overflow="hidden",s.style.overflow="hidden";const c=new SplitType(u,{types:"words"}),d=new SplitType(s,{types:"words"});gsap.set(c.words,{y:"100%",opacity:0}),gsap.set(d.words,{y:"100%",opacity:0}),gsap.to(c.words,{y:"0%",opacity:1,duration:.7,stagger:.03,ease:"power3.out"}),gsap.to(d.words,{y:"0%",opacity:1,duration:.7,stagger:.02,delay:.05,ease:"power3.out",onComplete:()=>{a.style.opacity="1",i.parentNode&&document.body.removeChild(i)}})}l&&l.parentNode&&document.body.removeChild(l),e&&(e.style.visibility="visible"),l=null,C=!1,Q=null,h=null,T=null,w=!0,B.style.cursor="grab",Y=0,A=0,D.classList.remove("active")}})}function me(){if(w){const e=t.dragEase;S+=(L-S)*e,E+=(N-E)*e,q.style.transform=`translate(${S}px, ${E}px)`;const n=Date.now();(Math.sqrt(Math.pow(S-le,2)+Math.pow(E-re,2))>100||n-de>120)&&(j(),le=S,re=E,de=n)}requestAnimationFrame(me)}B.addEventListener("mousedown",e=>{w&&(y=!0,R=!1,M=e.clientX,P=e.clientY,B.style.cursor="grabbing")});window.addEventListener("mousemove",e=>{if(!y||!w)return;const n=e.clientX-M,o=e.clientY-P;(Math.abs(n)>5||Math.abs(o)>5)&&(R=!0);const m=Date.now(),a=Math.max(10,m-se);se=m,Y=n/a,A=o/a,L+=n,N+=o,M=e.clientX,P=e.clientY});window.addEventListener("mouseup",e=>{if(y&&(y=!1,w&&(B.style.cursor="grab",Math.abs(Y)>.1||Math.abs(A)>.1))){const n=t.momentumFactor;L+=Y*n,N+=A*n}});D.addEventListener("click",()=>{C&&te()});B.addEventListener("touchstart",e=>{w&&(y=!0,R=!1,M=e.touches[0].clientX,P=e.touches[0].clientY)});window.addEventListener("touchmove",e=>{if(!y||!w)return;const n=e.touches[0].clientX-M,o=e.touches[0].clientY-P;(Math.abs(n)>5||Math.abs(o)>5)&&(R=!0),L+=n,N+=o,M=e.touches[0].clientX,P=e.touches[0].clientY});window.addEventListener("touchend",()=>{y=!1});window.addEventListener("resize",()=>{if(C&&l){const n=window.innerWidth*t.expandedScale,o=h.width,a=h.height/o,i=n*a;gsap.to(l,{width:n,height:i,duration:.3,ease:"power2.out"})}else j()});function He(){J(),K(),ee(),Z()}He();j();me();setTimeout(ce,500);
